{
    "metadata": {
        "package_name": "sample_malicious_package",
        "version": "0.0.1",
        "author": "Matej Skultety",
        "author_email": "xskultety@stuba.sk",
        "home_page": "",
        "package_url": ""
    },
    "timestamp": "2025-06-06 15:53:18",
    "final_verdict": "MALICIOUS",
    "evaluations": {
        "network": {
            "num_low_priority": 4,
            "num_high_priority": 0,
            "verdict": "SUSPICIOUS",
            "issues": [
                {
                    "priority": "LOW",
                    "rule": "IP without OTX details accessed",
                    "output": {
                        "ip": "185.15.59.226",
                        "asn": "14907",
                        "asn_description": "WIKIMEDIA, US",
                        "country": "NL",
                        "network_name": "Wikimedia-esams-infra"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "IP without OTX details accessed",
                    "output": {
                        "ip": "2a02:ec80:300:ed1a::3",
                        "asn": "14907",
                        "asn_description": "WIKIMEDIA, US",
                        "country": "NL",
                        "network_name": "US-WMF-20121130"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Unexpected domain accessed",
                    "output": {
                        "domain": "wikipedia.com",
                        "registrar": "MarkMonitor, Inc.",
                        "creation_date": "[datetime.datetime(2001, 1, 13, 0, 12, 14), datetime.datetime(2001, 1, 13, 0, 12, 14, tzinfo=datetime.timezone.utc)]",
                        "expiration_date": "[datetime.datetime(2026, 1, 10, 5, 28, 20), datetime.datetime(2026, 1, 10, 0, 0, tzinfo=datetime.timezone.utc)]",
                        "name_servers": [
                            "NS0.WIKIMEDIA.ORG",
                            "NS1.WIKIMEDIA.ORG",
                            "NS2.WIKIMEDIA.ORG"
                        ]
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Unexpected domain accessed",
                    "output": {
                        "domain": "www.package.test",
                        "registrar": null,
                        "creation_date": "None",
                        "expiration_date": "None",
                        "name_servers": null
                    }
                }
            ]
        },
        "syscalls": {
            "num_low_priority": 9,
            "num_high_priority": 15,
            "verdict": "MALICIOUS",
            "issues": [
                {
                    "priority": "HIGH",
                    "rule": "Modify authentication process",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217987588421508,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Crontab Modification via Subprocess",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217987594520476,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "crontab -l",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious Network Utility Execution",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217987594589267,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Crontab Modification via Subprocess",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217987598892782,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "crontab -",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Outbound HTTP/HTTPS Connection",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217987771197449,
                        "fd.sip": "185.15.59.226",
                        "fd.sport": 443,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Outbound HTTP/HTTPS Connection",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217987771795369,
                        "fd.sip": "185.15.59.226",
                        "fd.sport": 443,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Modify authentication process",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988100834522,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Crontab Modification via Subprocess",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988101886734,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "crontab -l",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious Network Utility Execution",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988102879814,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Crontab Modification via Subprocess",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988104698845,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "crontab -",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Outbound HTTP/HTTPS Connection",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988119936319,
                        "fd.sip": "185.15.59.226",
                        "fd.sport": 443,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Outbound HTTP/HTTPS Connection",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988120773053,
                        "fd.sip": "185.15.59.226",
                        "fd.sport": 443,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Modify authentication process",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988441571913,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Crontab Modification via Subprocess",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988442363376,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "crontab -l",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious Network Utility Execution",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988442872872,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Crontab Modification via Subprocess",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988446703790,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "crontab -",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Outbound HTTP/HTTPS Connection",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988466529577,
                        "fd.sip": "185.15.59.226",
                        "fd.sport": 443,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Outbound HTTP/HTTPS Connection",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988466958786,
                        "fd.sip": "185.15.59.226",
                        "fd.sport": 443,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Terminal shell in container",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.arg.flags": "EXE_WRITABLE|EXE_LOWER_LAYER",
                        "evt.time": 1749217988804610751,
                        "evt.type": "execve",
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "sh -c curl -s https://wikipedia.com",
                        "proc.exepath": "/usr/bin/dash",
                        "proc.name": "sh",
                        "proc.pname": null,
                        "proc.tty": 34816,
                        "user.loginuid": -1,
                        "user.name": "root",
                        "user.uid": 0
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Crontab Modification via Subprocess",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988805597158,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "crontab -l",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious Network Utility Execution",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988806153039,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Crontab Modification via Subprocess",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988809102884,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "crontab -",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Outbound HTTP/HTTPS Connection",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988823923984,
                        "fd.sip": "185.15.59.226",
                        "fd.sport": 443,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Outbound HTTP/HTTPS Connection",
                    "output": {
                        "container.id": "bd4ab52c7435",
                        "container.image.repository": "pydetective_sandbox_container",
                        "container.image.tag": "latest",
                        "container.name": "dazzling_sutherland",
                        "evt.time": 1749217988824781215,
                        "fd.sip": "185.15.59.226",
                        "fd.sport": 443,
                        "k8s.ns.name": null,
                        "k8s.pod.name": null,
                        "proc.cmdline": "curl -s https://wikipedia.com",
                        "user.name": "root"
                    }
                }
            ]
        },
        "static": {
            "num_low_priority": 2,
            "num_high_priority": 9,
            "verdict": "MALICIOUS",
            "issues": [
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_HTTPS_Env_Exfiltration",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/setup.py",
                        "meta": {
                            "description": "Detects code that exfiltrates environment variables via HTTPS POST request or similar network exfiltration.",
                            "author": "Matej Skultety",
                            "category": "network_exfiltration"
                        },
                        "strings": [
                            {
                                "identifier": "$env",
                                "offset": 4616,
                                "matched_data": "6f732e656e7669726f6e"
                            },
                            {
                                "identifier": "$https",
                                "offset": 1014,
                                "matched_data": "4854545053436f6e6e656374696f6e"
                            },
                            {
                                "identifier": "$post",
                                "offset": 483,
                                "matched_data": "706f7374"
                            },
                            {
                                "identifier": "$post",
                                "offset": 839,
                                "matched_data": "706f7374"
                            },
                            {
                                "identifier": "$post",
                                "offset": 912,
                                "matched_data": "504f5354"
                            },
                            {
                                "identifier": "$post",
                                "offset": 1212,
                                "matched_data": "504f5354"
                            },
                            {
                                "identifier": "$post",
                                "offset": 1221,
                                "matched_data": "706f7374"
                            },
                            {
                                "identifier": "$json",
                                "offset": 1167,
                                "matched_data": "6a736f6e2e64756d7073"
                            },
                            {
                                "identifier": "$header",
                                "offset": 1267,
                                "matched_data": "436f6e74656e742d54797065"
                            },
                            {
                                "identifier": "$url",
                                "offset": 1884,
                                "matched_data": "68747470733a2f2f"
                            }
                        ]
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_SSH_Key_Access",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/setup.py",
                        "meta": {
                            "description": "Detects code that accesses or modifies SSH keys in ~/.ssh directory or similar credential files.",
                            "author": "Matej Skultety",
                            "category": "credential_access"
                        },
                        "strings": [
                            {
                                "identifier": "$ssh_dir",
                                "offset": 2163,
                                "matched_data": "2e737368"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 1964,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 2377,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 2533,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 2911,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 3086,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 3486,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 3761,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 4975,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 6251,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$id_rsa",
                                "offset": 2215,
                                "matched_data": "69645f727361"
                            },
                            {
                                "identifier": "$id_rsa",
                                "offset": 2268,
                                "matched_data": "69645f727361"
                            }
                        ]
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Suspicious_Persistence_Simulation",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/setup.py",
                        "meta": {
                            "description": "Detects code that creates persistence mechanisms and also updates or writes files.",
                            "author": "Matej Skultety",
                            "category": "persistence",
                            "priority": "low"
                        },
                        "strings": [
                            {
                                "identifier": "$cron",
                                "offset": 3297,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3331,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3360,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3381,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3492,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3767,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$open",
                                "offset": 1964,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 2377,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 2533,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 2911,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 3086,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 3486,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 3761,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 4975,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 6251,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$write",
                                "offset": 4994,
                                "matched_data": "2e7772697465"
                            },
                            {
                                "identifier": "$write",
                                "offset": 6329,
                                "matched_data": "2e7772697465"
                            }
                        ]
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_Obfuscated_Code_During_Instalation",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/setup.py",
                        "meta": {
                            "description": "Detects base64, hex, or binary-encoded code that is decoded and executed dynamically.",
                            "author": "Matej Skultety",
                            "category": "obfuscation"
                        },
                        "strings": [
                            {
                                "identifier": "$base64",
                                "offset": 5280,
                                "matched_data": "6261736536342e6236346465636f6465"
                            },
                            {
                                "identifier": "$exec",
                                "offset": 5320,
                                "matched_data": "6578656328"
                            },
                            {
                                "identifier": "$exec",
                                "offset": 5742,
                                "matched_data": "6578656328"
                            },
                            {
                                "identifier": "$setup",
                                "offset": 5959,
                                "matched_data": "736574757028"
                            },
                            {
                                "identifier": "$binary",
                                "offset": 5001,
                                "matched_data": "6227"
                            },
                            {
                                "identifier": "$binary",
                                "offset": 5583,
                                "matched_data": "6227"
                            }
                        ]
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_System_Info_Collection",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/setup.py",
                        "meta": {
                            "description": "Detects code that collects system information such as username, hostname, OS details, Python version, and environment variables.",
                            "author": "Matej Skultety",
                            "category": "reconnaissance"
                        },
                        "strings": [
                            {
                                "identifier": "$uname",
                                "offset": 4421,
                                "matched_data": "706c6174666f726d2e756e616d65"
                            },
                            {
                                "identifier": "$getuser",
                                "offset": 4453,
                                "matched_data": "676574706173732e67657475736572"
                            },
                            {
                                "identifier": "$hostname1",
                                "offset": 4541,
                                "matched_data": "706c6174666f726d2e6e6f6465"
                            },
                            {
                                "identifier": "$hostname2",
                                "offset": 4641,
                                "matched_data": "736f636b65742e676574686f73746e616d65"
                            },
                            {
                                "identifier": "$system",
                                "offset": 4574,
                                "matched_data": "706c6174666f726d2e73797374656d"
                            }
                        ]
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_Process_Execution",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/setup.py",
                        "meta": {
                            "description": "Detects code that opens or spawns new processes using subprocess or os modules, or executes suspicious commands.",
                            "author": "Matej Skultety",
                            "category": "execution"
                        },
                        "strings": [
                            {
                                "identifier": "$subprocess_popen",
                                "offset": 3474,
                                "matched_data": "73756270726f636573732e506f70656e"
                            },
                            {
                                "identifier": "$subprocess_popen",
                                "offset": 3749,
                                "matched_data": "73756270726f636573732e506f70656e"
                            },
                            {
                                "identifier": "$os_popen",
                                "offset": 1960,
                                "matched_data": "6f732e706f70656e"
                            },
                            {
                                "identifier": "$cmd1",
                                "offset": 1833,
                                "matched_data": "6375726c20"
                            },
                            {
                                "identifier": "$cmd1",
                                "offset": 1932,
                                "matched_data": "6375726c20"
                            }
                        ]
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_HTTPS_Env_Exfiltration",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/src/sample_malicious_package/__init__.py",
                        "meta": {
                            "description": "Detects code that exfiltrates environment variables via HTTPS POST request or similar network exfiltration.",
                            "author": "Matej Skultety",
                            "category": "network_exfiltration"
                        },
                        "strings": [
                            {
                                "identifier": "$env",
                                "offset": 4597,
                                "matched_data": "6f732e656e7669726f6e"
                            },
                            {
                                "identifier": "$https",
                                "offset": 995,
                                "matched_data": "4854545053436f6e6e656374696f6e"
                            },
                            {
                                "identifier": "$post",
                                "offset": 464,
                                "matched_data": "706f7374"
                            },
                            {
                                "identifier": "$post",
                                "offset": 820,
                                "matched_data": "706f7374"
                            },
                            {
                                "identifier": "$post",
                                "offset": 893,
                                "matched_data": "504f5354"
                            },
                            {
                                "identifier": "$post",
                                "offset": 1193,
                                "matched_data": "504f5354"
                            },
                            {
                                "identifier": "$post",
                                "offset": 1202,
                                "matched_data": "706f7374"
                            },
                            {
                                "identifier": "$json",
                                "offset": 1148,
                                "matched_data": "6a736f6e2e64756d7073"
                            },
                            {
                                "identifier": "$header",
                                "offset": 1248,
                                "matched_data": "436f6e74656e742d54797065"
                            },
                            {
                                "identifier": "$url",
                                "offset": 1865,
                                "matched_data": "68747470733a2f2f"
                            }
                        ]
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_SSH_Key_Access",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/src/sample_malicious_package/__init__.py",
                        "meta": {
                            "description": "Detects code that accesses or modifies SSH keys in ~/.ssh directory or similar credential files.",
                            "author": "Matej Skultety",
                            "category": "credential_access"
                        },
                        "strings": [
                            {
                                "identifier": "$ssh_dir",
                                "offset": 2144,
                                "matched_data": "2e737368"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 1945,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 2358,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 2514,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 2892,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 3067,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 3467,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 3742,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 4956,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open_r",
                                "offset": 6004,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$id_rsa",
                                "offset": 2196,
                                "matched_data": "69645f727361"
                            },
                            {
                                "identifier": "$id_rsa",
                                "offset": 2249,
                                "matched_data": "69645f727361"
                            }
                        ]
                    }
                },
                {
                    "priority": "LOW",
                    "rule": "Suspicious_Persistence_Simulation",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/src/sample_malicious_package/__init__.py",
                        "meta": {
                            "description": "Detects code that creates persistence mechanisms and also updates or writes files.",
                            "author": "Matej Skultety",
                            "category": "persistence",
                            "priority": "low"
                        },
                        "strings": [
                            {
                                "identifier": "$cron",
                                "offset": 3278,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3312,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3341,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3362,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3473,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$cron",
                                "offset": 3748,
                                "matched_data": "63726f6e746162"
                            },
                            {
                                "identifier": "$open",
                                "offset": 1945,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 2358,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 2514,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 2892,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 3067,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 3467,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 3742,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 4956,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$open",
                                "offset": 6004,
                                "matched_data": "6f70656e28"
                            },
                            {
                                "identifier": "$write",
                                "offset": 4975,
                                "matched_data": "2e7772697465"
                            },
                            {
                                "identifier": "$write",
                                "offset": 6083,
                                "matched_data": "2e7772697465"
                            }
                        ]
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_System_Info_Collection",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/src/sample_malicious_package/__init__.py",
                        "meta": {
                            "description": "Detects code that collects system information such as username, hostname, OS details, Python version, and environment variables.",
                            "author": "Matej Skultety",
                            "category": "reconnaissance"
                        },
                        "strings": [
                            {
                                "identifier": "$uname",
                                "offset": 4402,
                                "matched_data": "706c6174666f726d2e756e616d65"
                            },
                            {
                                "identifier": "$getuser",
                                "offset": 4434,
                                "matched_data": "676574706173732e67657475736572"
                            },
                            {
                                "identifier": "$hostname1",
                                "offset": 4522,
                                "matched_data": "706c6174666f726d2e6e6f6465"
                            },
                            {
                                "identifier": "$hostname2",
                                "offset": 4622,
                                "matched_data": "736f636b65742e676574686f73746e616d65"
                            },
                            {
                                "identifier": "$system",
                                "offset": 4555,
                                "matched_data": "706c6174666f726d2e73797374656d"
                            }
                        ]
                    }
                },
                {
                    "priority": "HIGH",
                    "rule": "Suspicious_Process_Execution",
                    "output": {
                        "file": "sandbox/downloaded_package/extracted/sample_malicious_package/src/sample_malicious_package/__init__.py",
                        "meta": {
                            "description": "Detects code that opens or spawns new processes using subprocess or os modules, or executes suspicious commands.",
                            "author": "Matej Skultety",
                            "category": "execution"
                        },
                        "strings": [
                            {
                                "identifier": "$subprocess_popen",
                                "offset": 3455,
                                "matched_data": "73756270726f636573732e506f70656e"
                            },
                            {
                                "identifier": "$subprocess_popen",
                                "offset": 3730,
                                "matched_data": "73756270726f636573732e506f70656e"
                            },
                            {
                                "identifier": "$os_popen",
                                "offset": 1941,
                                "matched_data": "6f732e706f70656e"
                            },
                            {
                                "identifier": "$cmd1",
                                "offset": 1814,
                                "matched_data": "6375726c20"
                            },
                            {
                                "identifier": "$cmd1",
                                "offset": 1913,
                                "matched_data": "6375726c20"
                            }
                        ]
                    }
                }
            ]
        },
        "post_install": {
            "num_low_priority": 0,
            "num_high_priority": 0,
            "verdict": "SAFE",
            "issues": []
        }
    }
}
