# Detects execution of suspicious network utilities or exfiltration tools
- rule: Suspicious Network Utility Execution
  desc: Detects execution of curl, wget, nc, ncat, or python scripts that may exfiltrate data
  condition: (evt.type = execve and (proc.name in ("curl", "wget", "nc", "ncat", "python")))
  output: "Suspicious network utility execution (user=%user.name command=%proc.cmdline)"
  priority: WARNING
  tags: [network, exfiltration, process]

# Detects writing to persistence-related files or directories
- rule: Persistence File Write
  desc: Detects writing to crontab, systemd, or autorun locations
  condition: (evt.type = "open" and (fd.name contains "/etc/cron" or fd.name contains "/etc/systemd" or fd.name contains "autorun"))
  output: "Persistence file write (user=%user.name command=%proc.cmdline file=%fd.name)"
  priority: WARNING
  tags: [persistence, file, write]

# Detects execution of base64, python, or shell commands that may indicate obfuscation or code injection
- rule: Suspicious Obfuscated Code Execution
  desc: Detects execution of base64, python, or shell commands with suspicious arguments
  condition: (evt.type = execve and (proc.name in ("base64", "python", "python3", "sh", "bash") and (proc.cmdline contains "b64decode" or proc.cmdline contains "exec(" or proc.cmdline contains "marshal.loads" or proc.cmdline contains "fromhex")))
  output: "Suspicious obfuscated code execution (user=%user.name command=%proc.cmdline)"
  priority: WARNING
  tags: [obfuscation, code_exec, process]
